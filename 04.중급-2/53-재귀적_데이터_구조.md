# ì¬ê·€ì  ë°ì´í„° êµ¬ì¡°
ì´ êµ¬ì¡°ëŠ” `Composite Pattern` ì˜ í•µì‹¬ ì•„ì´ë””ì–´ë¥¼ ì˜ ë°˜ì˜.  
ì•„ë˜ì— ì´ ì½”ë“œê°€ ì–´ë–»ê²Œ `Composite Pattern` ê³¼ ì—°ê²°ë˜ëŠ”ì§€, ê·¸ë¦¬ê³  ì–´ë–¤ íŠ¹ì§•ì„ ê°–ëŠ”ì§€ ë‹¨ê³„ë³„ë¡œ ì„¤ëª….

## ğŸŒ³ `Composite Pattern` ì´ë€?
Composite Patternì€ ê°ì²´ë¥¼ íŠ¸ë¦¬ êµ¬ì¡°ë¡œ êµ¬ì„±í•˜ì—¬ ë¶€ë¶„-ì „ì²´ ê´€ê³„ë¥¼ ë™ì¼í•˜ê²Œ ë‹¤ë£° ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ë””ìì¸ íŒ¨í„´.
- `Component`: ê³µí†µ ì¸í„°í˜ì´ìŠ¤ ë˜ëŠ” ì¶”ìƒ í´ë˜ìŠ¤
- `Leaf`: ì‹¤ì œ ë™ì‘ì„ ìˆ˜í–‰í•˜ëŠ” ë‹¨ì¼ ê°ì²´
- `Composite`: ìì‹ë“¤ì„ í¬í•¨í•˜ê³ , ê³µí†µ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„

## ì „ì²´ ì½”ë“œ
```java
package com.thj;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;

public class CompositeTest {

    public abstract class Tree<T extends Tree>{
        public Tree(T parent){
            this.parent = parent;
            childrens = new ArrayList<>();
            if(parent != null){
                parent.childrens.add(this);
            }
        }

        public int getLevel() {
            return parent == null ? 0 : parent.getLevel() + 1;
        }

        public boolean isLeaf() {
            return childrens.size() == 0;
        }

        public boolean isRoot() {
            return parent == null;
        }

        public T parent;
        public List<T> childrens;

    }

    public class MyNode extends Tree<MyNode>{
        public MyNode(MyNode parent) {
            super(parent);
        }
    }

    /*
    Compile Error!!!
    public class MyInt extends Tree<Integer>{
        public MyInt(Integer parent) {
            super(parent);
        }
    }*/

    public static void main(String[] args) {
        CompositeTest.MyNode root = new CompositeTest().new MyNode(null);
        CompositeTest.MyNode child1 = new CompositeTest().new MyNode(root);
        CompositeTest.MyNode child2 = new CompositeTest().new MyNode(child1);
        System.out.println(child2.getLevel());
    }
}
```

## ğŸ” ì½”ë“œ ë¶„ì„: Composite Pattern ìš”ì†Œ

### âœ… 1. Tree<T extends Tree> â†’ Component ì—­í• 
```java
public abstract class Tree<T extends Tree> {
    public T parent;
    public List<T> childrens;
}
```
- ê³µí†µ ê¸°ëŠ¥ (getLevel(), isLeaf(), isRoot())ì„ ì •ì˜
- ìì‹ ë…¸ë“œë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ê´€ë¦¬ â†’ íŠ¸ë¦¬ êµ¬ì¡° í˜•ì„±

### âœ… 2. MyNode extends Tree<MyNode> â†’ Composite & Leaf ì—­í• 
```java
public class MyNode extends Tree<MyNode> {
    public MyNode(MyNode parent) {
        super(parent);
    }
}
```
- MyNodeëŠ” ìê¸° ìì‹ ì„ íƒ€ì…ìœ¼ë¡œ ì§€ì • â†’ ì¬ê·€ì  êµ¬ì¡°
- ìì‹ì´ ì—†ìœ¼ë©´ Leaf, ìì‹ì´ ìˆìœ¼ë©´ Composite ì—­í•  ìˆ˜í–‰

## ğŸ§  í•µì‹¬ íŠ¹ì§•
| êµ¬ì„± ìš”ì†Œ                        | ì„¤ëª…                                                                 |
|----------------------------------|----------------------------------------------------------------------|
| `parent`, `childrens`            | íŠ¸ë¦¬ êµ¬ì¡°ë¥¼ êµ¬ì„±í•˜ëŠ” ë¶€ëª¨-ìì‹ ê´€ê³„ í•„ë“œ                             |
| `Tree<T extends Tree>`, `MyNode extends Tree<MyNode>` | ì¬ê·€ì  ì œë„¤ë¦­ íƒ€ì…ì„ í†µí•œ êµ¬ì¡°ì  í™•ì¥ì„±                             |
| `Tree.getLevel()`, `isLeaf()`    | ê³µí†µ ê¸°ëŠ¥ ì œê³µ: ê¹Šì´ ê³„ì‚°, ë¦¬í”„ ì—¬ë¶€ í™•ì¸                            |
| `parent.childrens.add(this)`     | ìƒì„± ì‹œ ë¶€ëª¨ ë…¸ë“œì— ìì‹ ì„ ìë™ìœ¼ë¡œ ì¶”ê°€í•˜ì—¬ íŠ¸ë¦¬ ì—°ê²°               |


## ğŸš« ì™œ MyInt extends Tree<Integer>ëŠ” ì˜¤ë¥˜ì¼ê¹Œ?
```java
public class MyInt extends Tree<Integer> { ... }
```
- IntegerëŠ” Treeë¥¼ ìƒì†í•˜ì§€ ì•ŠìŒ â†’ T extends Tree ì œì•½ ì¡°ê±´ ìœ„ë°˜
- Tree<T>ëŠ” Tê°€ Treeì˜ í•˜ìœ„ íƒ€ì…ì´ì–´ì•¼ í•¨ â†’ ì¬ê·€ì  íƒ€ì… í•„ìš”

### ğŸ§ª ì‹¤í–‰ ì˜ˆì‹œ
```java
CompositeTest.MyNode root = new CompositeTest().new MyNode(null);
LockTest.MyNode child1 = new CompositeTest().new MyNode(root);
CompositeTest.MyNode child2 = new CompositeTest().new MyNode(child1);
System.out.println(child2.getLevel()); // ì¶œë ¥: 2
```
- child2ëŠ” root â†’ child1 â†’ child2 êµ¬ì¡°ì˜ 3ë‹¨ê³„ ì¤‘ ë§ˆì§€ë§‰
- getLevel()ì€ ë¶€ëª¨ë¥¼ ë”°ë¼ ì¬ê·€ì ìœ¼ë¡œ ê¹Šì´ë¥¼ ê³„ì‚°

## âœ¨ ìš”ì•½
| ì—­í•        | í´ë˜ìŠ¤/êµ¬ì¡°                   |
|------------|-------------------------------|
| Component  | `Tree<T extends Tree>`        |
| Composite  | `MyNode` (ìì‹ì´ ìˆëŠ” ê²½ìš°)    |
| Leaf       | `MyNode` (ìì‹ì´ ì—†ëŠ” ê²½ìš°)    |

---



