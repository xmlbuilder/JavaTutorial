# XML ìš”ì†Œ ì°¾ê¸°

## ğŸ§­ XML ì²˜ë¦¬ ë‹¨ê³„ë³„ ì„¤ëª…
### âœ… 1. XML íŒŒì„œ ì¤€ë¹„
```java
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
DocumentBuilder builder = factory.newDocumentBuilder();
Document document = builder.parse(...);
```
- XML íŒŒì¼ ë˜ëŠ” ë¬¸ìì—´ì„ íŒŒì‹±í•´ Document ê°ì²´ ìƒì„±
- DocumentBuilderFactoryëŠ” íŒŒì„œ ì„¤ì •ì„ ë‹´ë‹¹

### âœ… 2. ë£¨íŠ¸ ìš”ì†Œ ì ‘ê·¼
```java
Element root = document.getDocumentElement();
System.out.println(root.getNodeName());
```
- XMLì˜ ìµœìƒìœ„ ìš”ì†Œë¥¼ ê°€ì ¸ì˜´ (<novelists> ë“±)

### âœ… 3. íŠ¹ì • íƒœê·¸ íƒìƒ‰
```java
NodeList novelists = document.getElementsByTagName("novelist");
```
- ì›í•˜ëŠ” íƒœê·¸ ì´ë¦„ìœ¼ë¡œ ìš”ì†Œ ëª©ë¡ì„ ê°€ì ¸ì˜´
- ë°˜ë³µë¬¸ìœ¼ë¡œ ê° ë…¸ë“œì— ì ‘ê·¼ ê°€ëŠ¥

### âœ… 4. ìì‹ ìš”ì†Œ ì ‘ê·¼
```java
Element name = getChildElem((Element)node, "name");
```
- ì»¤ìŠ¤í…€ í•¨ìˆ˜ getChildElem()ì„ í†µí•´ ìì‹ ìš”ì†Œ íƒìƒ‰
- getFirstChild()ë¶€í„° getNextSibling()ê¹Œì§€ ìˆœíšŒ

### âœ… 5. í…ìŠ¤íŠ¸ ì¶”ì¶œ
```java
String nameText = name.getTextContent();
```
- ìš”ì†Œì˜ í…ìŠ¤íŠ¸ ê°’ì„ ê°€ì ¸ì˜´
- getContent() í•¨ìˆ˜ëŠ” CDATA, TEXT ë…¸ë“œë§Œ ì¶”ì¶œ

### âœ… 6. ë‚ ì§œ íŒŒì‹± ë° ê°ì²´ ìƒì„±
```java
SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
Date birth = formatter.parse(birthElement.getTextContent());
```
- ë¬¸ìì—´ì„ Date ê°ì²´ë¡œ ë³€í™˜
- NoveItem ê°ì²´ë¡œ êµ¬ì¡°í™”

### âœ… 7. ë¬¸ìì—´ ê¸°ë°˜ XML ì²˜ë¦¬
```java
Document doc = builder.parse(new InputSource(new StringReader(xmlString)));
```
- íŒŒì¼ ì—†ì´ ë¬¸ìì—´ë¡œ XMLì„ ì²˜ë¦¬í•  ìˆ˜ ìˆìŒ
- í…ŒìŠ¤íŠ¸ë‚˜ ë„¤íŠ¸ì›Œí¬ ì‘ë‹µ ì²˜ë¦¬ì— ìœ ìš©

## ğŸ§  í•µì‹¬ í•¨ìˆ˜ ìš”ì•½
| í•¨ìˆ˜ëª…             | ì—­í•  ë° ì„¤ëª…                                                  |
|--------------------|---------------------------------------------------------------|
| `getChildElem()`   | ë¶€ëª¨ ìš”ì†Œì—ì„œ íŠ¹ì • ì´ë¦„ì˜ ìì‹ ìš”ì†Œë¥¼ ì°¾ì•„ ë°˜í™˜               |
| `getContent()`     | ìš”ì†Œ ë‚´ë¶€ì˜ í…ìŠ¤íŠ¸/CDATA ë…¸ë“œë§Œ ì¶”ì¶œí•˜ì—¬ ë¬¸ìì—´ë¡œ ë°˜í™˜         |
| `getElementsByTagName()` | íŠ¹ì • íƒœê·¸ ì´ë¦„ìœ¼ë¡œ ìš”ì†Œ ëª©ë¡ì„ ê°€ì ¸ì˜´ (`NodeList`)         |
| `getDocumentElement()` | XMLì˜ ë£¨íŠ¸ ìš”ì†Œë¥¼ ë°˜í™˜ (`Element`)                          |
| `parse()`          | XML íŒŒì¼ ë˜ëŠ” ë¬¸ìì—´ì„ íŒŒì‹±í•˜ì—¬ `Document` ê°ì²´ ìƒì„±          |
| `getTextContent()` | ìš”ì†Œì˜ í…ìŠ¤íŠ¸ ê°’ì„ ë°˜í™˜                                        |
| `getNodeType()`    | ë…¸ë“œ íƒ€ì… í™•ì¸ (ELEMENT_NODE, TEXT_NODE ë“±)                   |

## âœ¨ ì „ì²´ íë¦„ ìš”ì•½
- 1. XML íŒŒì„œ ìƒì„± â†’ Document ê°ì²´ íšë“
- 2. ë£¨íŠ¸ ìš”ì†Œ ì ‘ê·¼ â†’ ì›í•˜ëŠ” íƒœê·¸ íƒìƒ‰
- 3. ìì‹ ìš”ì†Œ ì ‘ê·¼ â†’ í…ìŠ¤íŠ¸ ì¶”ì¶œ
- 4. í•„ìš”í•œ ë°ì´í„° êµ¬ì¡°í™” â†’ ê°ì²´ ìƒì„±
- 5. ê²°ê³¼ ì¶œë ¥ ë˜ëŠ” í™œìš©

---

# XML ìˆ˜ì •

## ğŸ§­ XML ì²˜ë¦¬ íë¦„ ë‹¨ê³„ë³„ ìš”ì•½
### âœ… 1. XML íŒŒì‹± (DOM ê¸°ë°˜)
- DocumentBuilderFactory â†’ íŒŒì„œ ìƒì„±
- DocumentBuilder â†’ XML ë¬¸ì„œ íŒŒì‹±
- Document â†’ DOM íŠ¸ë¦¬ êµ¬ì¡°ë¡œ í‘œí˜„
```java
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
DocumentBuilder builder = factory.newDocumentBuilder();
Document doc = builder.parse(new InputSource(new StringReader(xmlString)));
```

### âœ… 2. DOM íƒìƒ‰ ë° ë°ì´í„° ì¶”ì¶œ
- ë£¨íŠ¸ ìš”ì†Œ ì ‘ê·¼: getDocumentElement()
- íŠ¹ì • íƒœê·¸ íƒìƒ‰: getElementsByTagName("novelist")
- ìì‹ ìš”ì†Œ ì ‘ê·¼: getChildNodes(), getFirstChild(), getNextSibling()
- í…ìŠ¤íŠ¸ ì¶”ì¶œ: getTextContent(), getNodeValue()

### âœ… 3. XPathë¥¼ ì´ìš©í•œ ê³ ê¸‰ íƒìƒ‰
- XPathFactory â†’ XPath ê°ì²´ ìƒì„±
- XPathExpression â†’ ê²½ë¡œ ì»´íŒŒì¼
- evaluate() â†’ ë…¸ë“œ ì§‘í•© ë°˜í™˜
```java
XPath xpath = XPathFactory.newInstance().newXPath();
XPathExpression expr = xpath.compile("//novelists");
NodeList nodes = (NodeList) expr.evaluate(doc, XPathConstants.NODESET);
```

### âœ… 4. DOM ìˆ˜ì •
- ë…¸ë“œ ì‚­ì œ: parentNode.removeChild(targetNode)
- ë…¸ë“œ ì¶”ê°€: appendChild(), createElement()

### âœ… 5. XML ì§ë ¬í™” ë° ì—­ì§ë ¬í™” (Java Beans)
- XMLEncoder â†’ ê°ì²´ë¥¼ XMLë¡œ ì €ì¥
- XMLDecoder â†’ XMLì—ì„œ ê°ì²´ ë³µì›
```java
XMLEncoder encoder = new XMLEncoder(new FileOutputStream("file.xml"));
encoder.writeObject(obj);
encoder.close();

XMLDecoder decoder = new XMLDecoder(new FileInputStream("file.xml"));
Object obj = decoder.readObject();
decoder.close();
```

### âœ… 6. íŒŒì¼ ì ê¸ˆ ì²˜ë¦¬ (NIO)
- FileChannel.lock() â†’ íŒŒì¼ ì“°ê¸° ì¤‘ ë™ì‹œ ì ‘ê·¼ ë°©ì§€
- ByteBuffer â†’ ë°”ì´íŠ¸ ë‹¨ìœ„ ì“°ê¸°

## ğŸ§  í•µì‹¬ í´ë˜ìŠ¤ ë° í•¨ìˆ˜ ìš”ì•½
| í´ë˜ìŠ¤/ì¸í„°í˜ì´ìŠ¤        | ì—­í•  ë° ì„¤ëª…                                                  |
|--------------------------|---------------------------------------------------------------|
| `DocumentBuilderFactory` | XML íŒŒì„œ íŒ©í† ë¦¬ ìƒì„±                                          |
| `DocumentBuilder`        | XML ë¬¸ì„œ íŒŒì‹±                                                 |
| `Document`               | DOM íŠ¸ë¦¬ êµ¬ì¡° í‘œí˜„                                            |
| `Element`, `Node`        | XML ìš”ì†Œ ë° ë…¸ë“œ í‘œí˜„                                         |
| `NodeList`               | ë‹¤ìˆ˜ ë…¸ë“œ ì§‘í•©                                                |
| `XPath`, `XPathExpression` | XPath ê²½ë¡œ íƒìƒ‰ ë° í‰ê°€                                      |
| `XMLEncoder`             | Java ê°ì²´ë¥¼ XMLë¡œ ì§ë ¬í™”                                      |
| `XMLDecoder`             | XMLì—ì„œ Java ê°ì²´ë¡œ ì—­ì§ë ¬í™”                                  |
| `Transformer`            | DOM â†’ XML ë¬¸ìì—´ë¡œ ë³€í™˜                                       |
| `FileChannel`, `FileLock`| íŒŒì¼ ì“°ê¸° ì‹œ ë™ì‹œ ì ‘ê·¼ ì œì–´                                   |

## âœ¨ ì£¼ìš” í•¨ìˆ˜ ìš”ì•½
| í•¨ìˆ˜ëª…              | ì„¤ëª…                                                             |
|---------------------|------------------------------------------------------------------|
| `parse()`           | XML ë¬¸ìì—´ ë˜ëŠ” íŒŒì¼ì„ DOM êµ¬ì¡°ë¡œ íŒŒì‹±                           |
| `getDocumentElement()` | ë£¨íŠ¸ ìš”ì†Œ ë°˜í™˜                                                  |
| `getElementsByTagName()` | íŠ¹ì • íƒœê·¸ ì´ë¦„ìœ¼ë¡œ ìš”ì†Œ ì§‘í•© ë°˜í™˜                             |
| `getTextContent()`  | ìš”ì†Œì˜ í…ìŠ¤íŠ¸ ë‚´ìš© ì¶”ì¶œ                                          |
| `evaluate()`        | XPath ê²½ë¡œ í‰ê°€ í›„ ê²°ê³¼ ë°˜í™˜                                     |
| `removeChild()`     | íŠ¹ì • ë…¸ë“œë¥¼ DOM íŠ¸ë¦¬ì—ì„œ ì œê±°                                    |
| `writeObject()`     | ê°ì²´ë¥¼ XMLë¡œ ì§ë ¬í™”                                              |
| `readObject()`      | XMLì—ì„œ ê°ì²´ ë³µì›                                                |
| `lock()` / `release()` | íŒŒì¼ ì ê¸ˆ ë° í•´ì œ                                               |

## ğŸ“¦ í™œìš© ì˜ˆì‹œ
- ì„¤ì • íŒŒì¼ ì²˜ë¦¬: UserSettings ê°ì²´ë¥¼ XMLë¡œ ì €ì¥/ë³µì›
- ë°ì´í„° êµ¬ì¡° ì§ë ¬í™”: Collegeì™€ Student ê°ì²´ë¥¼ XMLë¡œ ì €ì¥
- XPath ê¸°ë°˜ í•„í„°ë§: íŠ¹ì • ì¡°ê±´ì˜ ë…¸ë“œë§Œ ì¶”ì¶œ
- íŒŒì¼ ë™ê¸°í™” ì œì–´: FileLockìœ¼ë¡œ ë‹¤ì¤‘ ì“°ê¸° ë°©ì§€

## ìƒ˜í”Œ ì½”ë“œ

### 1. XML íŒŒì¼ ì…ë ¥
```java
package com.thj;
import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;
import org.xml.sax.SAXException;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;
import java.io.IOException;

public class XMLParserTest {
    public static void main(String[] args) throws ParserConfigurationException, IOException, SAXException {

        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        DocumentBuilder documentBuilder = factory.newDocumentBuilder();
        
        Document document = documentBuilder.parse("/Users/jeongjunghwan/Development/Temp/novelists.xml");
        
        Element root = document.getDocumentElement();
        System.out.println(root.getNodeName());
        
        NodeList childrent = root.getChildNodes();
        for(int i=0; i<childrent.getLength(); i++){
            Node node = childrent.item(i);
            NodeList child1 = node.getChildNodes();
            for(int j=0; j<child1.getLength(); j++)
            {
                Node childNode = child1.item(j);
                if(childNode.getNodeType() == Node.ELEMENT_NODE){
                    Element element = (Element) childNode;
                    if(!childNode.getNodeName().isEmpty()){
                        System.out.println(childNode.getNodeName() + " : " + element.getTextContent().trim());
                    }
                }
            }
        }
    }
}
```

### 2. XML Query
```java
package com.thj;
import org.w3c.dom.*;
import org.xml.sax.SAXException;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;
import java.io.IOException;
public class XMLParserTest {
    public static void main(String[] args) throws ParserConfigurationException, IOException, SAXException {
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        DocumentBuilder documentBuilder = factory.newDocumentBuilder();
        Document document = documentBuilder.parse("/Users/jeongjunghwan/Development/Temp/novelists.xml");
        Element root = document.getDocumentElement();
        NodeList nodelists = document.getElementsByTagName("novelist");
        System.out.println(nodelists.getLength());
        for(int i=0; i<nodelists.getLength(); i++){
            Node node = nodelists.item(i);
            Element name = getChildElem((Element) node, "name");
            Element birth = getChildElem((Element)node, "birth");
            System.out.println(name.getTextContent());
            System.out.println(birth.getTextContent());
        }
    }
    public static String getContent(Element elem){
        NodeList nodeList = elem.getChildNodes();
        StringBuffer content = new StringBuffer();
        for(int i=0; i<nodeList.getLength(); i++){
            Node node = nodeList.item(i);
            switch (node.getNodeType()){
                case Node.ELEMENT_NODE:
                    continue;
                case Node.CDATA_SECTION_NODE:
                case Node.TEXT_NODE:
                    content.append(node.getNodeValue());
                    break;
            }
        }
        return content.toString().trim();
    }
    public static Element getChildElem(Element parent, String name){
        for(Node child = parent.getFirstChild(); child != null; child = child.getNextSibling()){
            if(child instanceof Element && name.equals(child.getNodeName())){
                return (Element) child;
            }
        }
        return null;
    }
}

var xdoc = XDocument.Load("/Users/jeongjunghwan/Development/Temp/novelists.xml");
var xnovelists = xdoc.Root.Elements();
foreach (var xnovelist in xnovelists)
{
    var xname = xnovelist.Element("name");
    var works = xnovelist.Element("masterpieces")
        .Elements("title").Select(x => x.Value.Trim());
    
    Console.WriteLine($"{xname.Value} {String.Join(", ", works)}");
}

```

### 3. ì‚¬ìš©ì ì§€ì • í´ë˜ìŠ¤ í˜•íƒœë¡œ ì¶”ì¶œ
```java
package com.thj;
import org.w3c.dom.*;
import org.xml.sax.SAXException;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;
import java.io.IOException;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

public class XMLParserTest {

    class NoveItem {
        private String name;
        private Date birth;
        private Date death;
        private List<String> masterpieces = new ArrayList<>();
        public NoveItem(String name, Date birth, Date death, List<String> masterpieces) {
            this.name = name;
            this.birth = birth;
            this.death = death;
            this.masterpieces = masterpieces;
        }
        public String getName() {
            return name;
        }
        public Date getBirth() {
            return birth;
        }
        public Date getDeath() {
            return death;
        }
        public List<String> getMasterpieces() {
            return masterpieces;
        }
    }
    public static void main(String[] args) throws ParserConfigurationException, IOException, SAXException, ParseException {
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        DocumentBuilder documentBuilder = factory.newDocumentBuilder();
        Document document = documentBuilder.parse("/Users/jeongjunghwan/Development/Temp/novelists.xml");
        Element root = document.getDocumentElement();
        NodeList novelists = document.getElementsByTagName("novelist");
        List<NoveItem> noveItemList = new ArrayList<>();
        for(int i=0; i<novelists.getLength(); i++){
            Node node = novelists.item(i);
            Element name = getChildElem((Element)node, "name");
            Element birth = getChildElem((Element)node, "birth");
            Element death = getChildElem((Element)node, "death");
            Element masterpieces = getChildElem((Element) node, "masterpieces");
            NodeList titles = masterpieces.getElementsByTagName("title");
            List<String> listMasterPieces = new ArrayList<>();
            for(int j=0; j<titles.getLength(); j++){
                Element title = (Element) titles.item(j);
                listMasterPieces.add(title.getTextContent());
            }
            String strName = name.getTextContent();
            SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
            Date dateBirth = formatter.parse(birth.getTextContent());
            Date dateDeath = formatter.parse(death.getTextContent());
            XMLParserTest.NoveItem noveItem = new XMLParserTest().new NoveItem(strName, dateBirth, dateDeath, listMasterPieces);
            noveItemList.add(noveItem);
        }
        for(var nove :  noveItemList){
            System.out.println(nove.getName());
            System.out.println(nove.getBirth());
            System.out.println(nove.getDeath());
            System.out.println(nove.getMasterpieces().size());
            System.out.println(String.join(", ", nove.getMasterpieces()));
        }
    }
    public static String getContent(Element elem){
        NodeList nodeList = elem.getChildNodes();
        StringBuffer content = new StringBuffer();
        for(int i=0; i<nodeList.getLength(); i++){
            Node node = nodeList.item(i);
            switch (node.getNodeType()){
                case Node.ELEMENT_NODE:
                    continue;
                case Node.CDATA_SECTION_NODE:
                case Node.TEXT_NODE:
                    content.append(node.getNodeValue());
                    break;
            }
        }
        return content.toString().trim();
    }
    public static Element getChildElem(Element parent, String name){
        for(Node child = parent.getFirstChild(); child != null; child = child.getNextSibling()){
            if(child instanceof Element && name.equals(child.getNodeName())){
                return (Element) child;
            }
        }
        return null;
    }
}
```

### 4. XML - ë¬¸ìì—´ XML íŒŒì‹±
```java
package com.thj;
import org.w3c.dom.*;
import org.xml.sax.InputSource;
import org.xml.sax.SAXException;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.StringReader;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
public class XMLParserTest {
    public static void main(String[] args) throws ParserConfigurationException, IOException, SAXException, ParseException {

        StringBuffer sb = new StringBuffer();
        sb.append("<?xml version=\"1.0\" encoding=\"utf-8\"?>");
        sb.append("<novelists>");
        sb.append("<novelist>");
        sb.append("<name eng=\"Sidney Sheldon\">ì‹œë“œë‹ˆ ì…¸ë˜</name>");
        sb.append("<birth>1917-02-11</birth>");
        sb.append("<death>2007-01-30</death>");
        sb.append("<masterpieces>");
        sb.append("<title>ê²Œì„ì˜ ì—¬ì™•</title>");
        sb.append("<title>ì²œì‚¬ì˜ ë¶„ë…¸</title>");
        sb.append("</masterpieces>");
        sb.append("</novelist>");
        sb.append("</novelists>");
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        DocumentBuilder documentBuilder = factory.newDocumentBuilder();
        Document document = documentBuilder.parse(new InputSource(new StringReader(sb.toString())));

        Element root = document.getDocumentElement();
        NodeList novelists = document.getElementsByTagName("novelist");
        System.out.println(novelists.getLength());
    }
}

```

### 5. XML - xpath ì‚¬ìš©
```java
package com.thj;
import org.w3c.dom.*;
import org.xml.sax.InputSource;
import org.xml.sax.SAXException;

import javax.sql.rowset.spi.XmlWriter;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;
import javax.xml.transform.*;
import javax.xml.transform.dom.DOMSource;
import javax.xml.transform.stream.StreamResult;
import javax.xml.xpath.*;
import java.io.*;
import java.nio.charset.StandardCharsets;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

public class XMLParserTest {
    public static void main(String[] args) throws ParserConfigurationException, IOException, SAXException, TransformerException, XPathExpressionException {
        StringBuffer sb = new StringBuffer();
        sb.append("<?xml version=\"1.0\" encoding=\"utf-8\"?>");
        sb.append("<novelists>");
        sb.append("<novelist>");
        sb.append("<name eng=\"Sidney Sheldon\">ì‹œë“œë‹ˆ ì…¸ë˜</name>");
        sb.append("<birth>1917-02-11</birth>");
        sb.append("<death>2007-01-30</death>");
        sb.append("<masterpieces>");
        sb.append("<title>ê²Œì„ì˜ ì—¬ì™•</title>");
        sb.append("<title>ì²œì‚¬ì˜ ë¶„ë…¸</title>");
        sb.append("</masterpieces>");
        sb.append("</novelist>");
        sb.append("</novelists>");
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        DocumentBuilder documentBuilder = factory.newDocumentBuilder();
        Document document = documentBuilder.parse(new InputSource(new StringReader(sb.toString())));

        XPathFactory xPathFactory = XPathFactory.newInstance();
        XPath xpath = xPathFactory.newXPath();
        XPathExpression expr = xpath.compile("//novelists");
        Object result = expr.evaluate(document, XPathConstants.NODESET);
        NodeList nodes = (NodeList) result;
        System.out.println(nodes.getLength());
        for(int i=0; i<nodes.getLength(); i++){
            Node node = nodes.item(i);
            System.out.println(node.getTextContent());
        }
    }
}
```

### 6. XML - XML ìš”ì†Œ ì œê±°
```java
package com.thj;
import org.w3c.dom.*;
import org.xml.sax.InputSource;
import org.xml.sax.SAXException;

import javax.sql.rowset.spi.XmlWriter;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;
import javax.xml.transform.*;
import javax.xml.transform.dom.DOMSource;
import javax.xml.transform.stream.StreamResult;
import javax.xml.xpath.*;
import java.io.*;
import java.nio.charset.StandardCharsets;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

public class XMLParserTest {
    public static void main(String[] args) throws ParserConfigurationException, IOException, SAXException, TransformerException, XPathExpressionException {
        StringBuffer sb = new StringBuffer();
        sb.append("<?xml version=\"1.0\" encoding=\"utf-8\"?>");
        sb.append("<novelists>");
        sb.append("<novelist>");
        sb.append("<name eng=\"Sidney Sheldon\">ì‹œë“œë‹ˆ ì…¸ë˜</name>");
        sb.append("<birth>1917-02-11</birth>");
        sb.append("<death>2007-01-30</death>");
        sb.append("<masterpieces>");
        sb.append("<title>ê²Œì„ì˜ ì—¬ì™•</title>");
        sb.append("<title>ì²œì‚¬ì˜ ë¶„ë…¸</title>");
        sb.append("</masterpieces>");
        sb.append("</novelist>");
        sb.append("</novelists>");
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        DocumentBuilder documentBuilder = factory.newDocumentBuilder();
        Document document = documentBuilder.parse(new InputSource(new StringReader(sb.toString())));
        XPathFactory xPathFactory = XPathFactory.newInstance();
        XPath xpath = xPathFactory.newXPath();
        XPathExpression expr = xpath.compile("//novelists");
        Object result = expr.evaluate(document, XPathConstants.NODESET);
        NodeList nodes = (NodeList) result;
        System.out.println(nodes.getLength());
        if(nodes.getLength() == 0) return;
        Node removeNode = nodes.item(0);
        Node parentNode = removeNode.getParentNode();
        if(parentNode != null){
            parentNode.removeChild(removeNode);
        }
        result = expr.evaluate(document, XPathConstants.NODESET);
        NodeList newNodes = (NodeList) result;
        System.out.println(newNodes.getLength());

        for(int i=0; i<nodes.getLength(); i++){
            Node node = nodes.item(i);
            System.out.println(node.getTextContent());
        }
    }
}

```

### 7. ê°ì²´ë¥¼ XMLë¡œ
```java
package com.thj;

public class UserSettings
{
    public UserSettings(){}
    private Integer fieldOne;
    private String fieldTwo;
    private boolean fieldThree;
    public Integer getFieldOne() {
        return fieldOne;
    }
    public void setFieldOne(Integer fieldOne) {
        this.fieldOne = fieldOne;
    }
    public String getFieldTwo() {
        return fieldTwo;
    }
    public void setFieldTwo(String fieldTwo) {
        this.fieldTwo = fieldTwo;
    }
    public boolean isFieldThree() {
        return fieldThree;
    }
    public void setFieldThree(boolean fieldThree) {
        this.fieldThree = fieldThree;
    }
    @Override
    public String toString() {
        return "UserSettings{" +
                "fieldOne=" + fieldOne +
                ", fieldTwo='" + fieldTwo + '\'' +
                ", fieldThree=" + fieldThree +
                '}';
    }
}
package com.thj;
import org.xml.sax.SAXException;

import javax.xml.parsers.ParserConfigurationException;
import javax.xml.transform.*;
import javax.xml.xpath.*;
import java.beans.ExceptionListener;
import java.beans.XMLDecoder;
import java.beans.XMLEncoder;
import java.io.*;

public class XMLParserTest {
    private static void serializeToXML(UserSettings userSettings, String filePath){
        try(FileOutputStream fos = new FileOutputStream(filePath)) {
            XMLEncoder encoder = new XMLEncoder(fos);
            encoder.setExceptionListener(new ExceptionListener() {
                @Override
                public void exceptionThrown(Exception e) {
                    System.out.println("Exception! : " + e.toString());
                }
            });
            encoder.writeObject(userSettings);
            encoder.close();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    private static UserSettings deserizableFromXML(String strFilePath){
        UserSettings userSettings = null;
        try(FileInputStream fis = new FileInputStream(strFilePath)){
            XMLDecoder decoder = new XMLDecoder(fis);
            userSettings = (UserSettings)decoder.readObject();
            decoder.close();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return userSettings;
    }

    public static void main(String[] args) throws ParserConfigurationException, IOException, SAXException, TransformerException, XPathExpressionException {
        UserSettings userSettings = new UserSettings();
        userSettings.setFieldOne(1);
        userSettings.setFieldTwo("sample");
        serializeToXML(userSettings, "/Users/jeongjunghwan/Downloads/Sample123.xml");
        UserSettings readObj = deserizableFromXML("/Users/jeongjunghwan/Downloads/Sample123.xml");
        System.out.println(readObj);

    }
}
```

### 8. XML - ê°ì²´ Serialize
```java
package com.thj;
import java.beans.XMLEncoder;
import java.io.BufferedOutputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

public class XMLSerializeTest {
    public static void main(String[] args){
        Student student1 = new Student();
        student1.setRollno(1);
        student1.setName("sample1");
        Student student2 = new Student();
        student2.setRollno(2);
        student2.setName("sample2");
        List<Student> s = new ArrayList<>();
        s.add(student1);
        s.add(student2);
        College c = new College();
        c.setStudents(s);
        String strFileName = "/Users/jeongjunghwan/Downloads/SampleSerial.xml";
        try(BufferedOutputStream bufferedOutputStream = new BufferedOutputStream(new FileOutputStream(strFileName))){
            XMLEncoder encoder = new XMLEncoder(bufferedOutputStream);
            encoder.writeObject(c);
            encoder.close();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

    }
}
package com.thj;
import java.util.List;
public class College {
    private List<Student> students;
    public List<Student> getStudents() {
        return students;
    }
    public void setStudents(List<Student> students) {
        this.students = students;
    }
}

package com.thj;
public class Student {
    private int rollno;
    private String name;
    public int getRollno() {
        return rollno;
    }
    public void setRollno(int rollno) {
        this.rollno = rollno;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
}
```

### 9. XML - íŒŒì¼ ì ê·¸ê¸°
```java
package com.thj;
import java.io.FileOutputStream;
import java.nio.ByteBuffer;
import java.nio.channels.FileChannel;
import java.nio.channels.FileLock;
public class FileLockTest {
    public static void main(String[] args){
        try(FileOutputStream out = new FileOutputStream("/Users/jeongjunghwan/Downloads/sample.txt");
            FileChannel channel = out.getChannel()) {
            FileLock lock = channel.lock();
            try{
                ByteBuffer byteBuffer = ByteBuffer.allocate(10);
                byteBuffer.put(0, (byte)10);
                byteBuffer.put(1, (byte)12);
                byteBuffer.put(2, (byte)33);
                channel.write(byteBuffer);
            }finally {
                lock.release();
            }

        }catch (Exception ex){
        }
    }
}
```

---
