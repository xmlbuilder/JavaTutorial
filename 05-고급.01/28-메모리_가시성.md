# ë©”ëª¨ë¦¬ ê°€ì‹œì„± 1

## ì „ì²´ ì½”ë“œ
```java
public class VolatileFlagMain {
    public static void main(String[] args) {
        MyTask task = new MyTask();
        Thread t = new Thread(task, "work");
        log("runFlag = " + task.runFlag);
        t.start();

        sleep(1000);

        log("runFlagë¥¼ falseë¡œ ë³€ê²½ ì‹œë„");
        task.runFlag = false;
        log("runFlag = " + task.runFlag);
        log("main ì¢…ë£Œ");
    }

    static class MyTask implements Runnable {
        boolean runFlag = true;
        //volatile boolean runFlag = true;
        
        @Override
        public void run() {
            log("task ì‹œì‘");
            while (runFlag) {
                // runFlagê°€ falseë¡œ ë³€í•˜ë©´ íƒˆì¶œ
            }
            log("task ì¢…ë£Œ");
        }
    }
}
```

## ğŸ§  ë©”ëª¨ë¦¬ ê°€ì‹œì„± ë¬¸ì œ: volatile ì—†ì´ ë°œìƒí•˜ëŠ” í˜„ìƒ
```mermaid
graph TD
    subgraph Heap ì˜ì—­
        A[MyTask ì¸ìŠ¤í„´ìŠ¤ (x001)]
        A --> B[runFlag = true]
    end

    subgraph main ìŠ¤íƒ
        M[main() frame]
        M --> C[task = x001]
    end

    subgraph work ìŠ¤íƒ
        W[run() frame]
        W --> D[this = x001]
        D --> E[while(runFlag)]
    end

    C --> A
    D --> A

    style A fill:#f9f,stroke:#333,stroke-width:1px
    style B fill:#fff,stroke:#333,stroke-width:1px
    style C fill:#bbf,stroke:#333,stroke-width:1px
    style D fill:#bbf,stroke:#333,stroke-width:1px
    style E fill:#ff9,stroke:#333,stroke-width:1px

```

## ğŸ” ì„¤ëª…
- main() ìŠ¤ë ˆë“œì™€ run() ìŠ¤ë ˆë“œëŠ” ëª¨ë‘ MyTask ì¸ìŠ¤í„´ìŠ¤ x001ì„ ì°¸ì¡°
- `runFlag` ëŠ” x001 ê°ì²´ì˜ í•„ë“œì´ë©°, `ë‘ ìŠ¤ë ˆë“œê°€ ê³µìœ `
- `main()` ìŠ¤ë ˆë“œê°€ `runFlag = false` ë¡œ ë³€ê²½í•´ë„, `work ìŠ¤ë ˆë“œ` ê°€ ìì‹ ì˜ `ìºì‹œëœ ê°’` ì„ `ê³„ì† ì°¸ì¡°` í•  ìˆ˜ ìˆìŒ
- ì´ë¡œ ì¸í•´ while(runFlag) ë£¨í”„ê°€ ëë‚˜ì§€ ì•Šê³  ê³„ì† ì‹¤í–‰ë¨ â†’ ë©”ëª¨ë¦¬ ê°€ì‹œì„± ë¬¸ì œ

## âœ… í•´ê²° ë°©ë²•
- runFlagì— volatile í‚¤ì›Œë“œë¥¼ ë¶™ì´ë©´ í•´ê²°ë¨:
```java
volatile boolean runFlag = true;
```
- volatileì€ ë³€ê²½ëœ ê°’ì„ ëª¨ë“  ìŠ¤ë ˆë“œê°€ ì¦‰ì‹œ ë³¼ ìˆ˜ ìˆë„ë¡ ë³´ì¥í•¨
- ì¦‰, main() ìŠ¤ë ˆë“œê°€ ê°’ì„ ë°”ê¾¸ë©´ work ìŠ¤ë ˆë“œë„ ì¦‰ì‹œ ì¸ì§€í•¨

---
