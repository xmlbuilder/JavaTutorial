# μΈν„°λ½νΈ 3

## μ½”λ“
```java
public class ThreadStopMainV3 {
    public static void main(String[] args) {
        MyTask task = new MyTask();
        Thread thread = new Thread(task, "work");
        thread.start();

        sleep(100); // μ‹κ°„μ„ μ¤„μ„
        log("μ‘μ—… μ¤‘λ‹¨ μ§€μ‹ - thread.interrupt()");

        thread.interrupt();
        log("work μ¤λ λ“ μΈν„°λ½νΈ μƒνƒ1 = " + thread.isInterrupted());
    }
    static class MyTask implements Runnable {
        @Override
        public void run() {
            while (!Thread.currentThread().isInterrupted()) { // μΈν„°λ½νΈ μƒνƒ λ³€κ²½X
                log("μ‘μ—… μ¤‘");
            }
            log("work μ¤λ λ“ μΈν„°λ½νΈ μƒνƒ2 = " + Thread.currentThread().isInterrupted());

            try {
                log("μμ› μ •λ¦¬ μ‹λ„");
                Thread.sleep(1000);
                log("μμ› μ •λ¦¬ μ™„λ£");
            } catch (InterruptedException e) {
                log("μμ› μ •λ¦¬ μ‹¤ν¨ - μμ› μ •λ¦¬ μ¤‘ μΈν„°λ½νΈ λ°μƒ");
                log("work μ¤λ λ“ μΈν„°λ½νΈ μƒνƒ3 = " +
                Thread.currentThread().isInterrupted());
            }

            log("μ‘μ—… μΆ…λ£");
        }
    }
}
```

## π§µμΈν„°λ½νΈ μƒνƒ μ§μ ‘ ν™•μΈ + μμ› μ •λ¦¬ μ‹¤ν¨ νλ¦„
```mermaid
sequenceDiagram
    participant MainThread
    participant WorkThread

    Note over MainThread: ν”„λ΅κ·Έλ¨ μ‹μ‘
    MainThread->>WorkThread: Thread.start() νΈμ¶
    WorkThread->>WorkThread: while (!isInterrupted()) λ°λ³µ μ‹μ‘

    loop μ‘μ—… λ£¨ν”„
        WorkThread->>WorkThread: log("μ‘μ—… μ¤‘")
    end

    Note over MainThread: sleep(100ms) ν›„ μΈν„°λ½νΈ μ§€μ‹
    MainThread->>WorkThread: thread.interrupt() νΈμ¶
    MainThread->>MainThread: log("μΈν„°λ½νΈ μƒνƒ1 = true")

    WorkThread->>WorkThread: μΈν„°λ½νΈ μƒνƒ ν™•μΈ<br>β†’ while νƒμ¶
    WorkThread->>WorkThread: log("μΈν„°λ½νΈ μƒνƒ2 = true")

    Note over WorkThread: μμ› μ •λ¦¬ μ‹λ„
    WorkThread->>WorkThread: Thread.sleep(1000) νΈμ¶
    WorkThread->>WorkThread: InterruptedException λ°μƒ<br>β†’ catch μ§„μ…
    WorkThread->>WorkThread: log("μμ› μ •λ¦¬ μ‹¤ν¨")<br>log("μΈν„°λ½νΈ μƒνƒ3 = false")
    WorkThread->>WorkThread: log("μ‘μ—… μΆ…λ£")
```


## π” ν•µμ‹¬ νλ¦„ μ”μ•½
- work μ¤λ λ“λ” isInterrupted()λ΅ μΈν„°λ½νΈ μƒνƒλ¥Ό μ§μ ‘ ν™•μΈν•κ³  λ°λ³µλ¬Έ νƒμ¶
- ν•μ§€λ§ μΈν„°λ½νΈ μƒνƒκ°€ trueλ΅ μ μ§€λ μ±„ μμ› μ •λ¦¬ μ½”λ“(sleep())λ¥Ό μ‹¤ν–‰
- κ·Έ κ²°κ³Ό InterruptedExceptionμ΄ λ°μƒν•μ—¬ μμ› μ •λ¦¬μ— μ‹¤ν¨
- μμ™Έ λ°μƒ ν›„ μΈν„°λ½νΈ μƒνƒλ” μλ™μΌλ΅ falseλ΅ μ΄κΈ°ν™”λ¨


## β… κµν› λ° κ°μ„  ν¬μΈνΈ

| ν•­λ©                     | μ„¤λ…                                                                 | κ΄€λ ¨ μ„μΉ λλ” λ©”μ„λ“             |
|--------------------------|----------------------------------------------------------------------|-----------------------------------|
| isInterrupted()          | ν„μ¬ μ¤λ λ“μ μΈν„°λ½νΈ μƒνƒλ¥Ό ν™•μΈν•μ§€λ§ μƒνƒλ¥Ό μ΄κΈ°ν™”ν•μ§€ μ•μ       | while μ΅°κ±΄λ¬Έ, λ°λ³µλ¬Έ νƒμ¶μ©       |
| sleep()                  | μΈν„°λ½νΈ μƒνƒμΌ κ²½μ° μμ™Έ λ°μƒ β†’ μμ› μ •λ¦¬ μ¤‘ μμ™Έλ΅ μ‹¤ν¨ κ°€λ¥         | μμ› μ •λ¦¬ λ‹¨κ³„μ—μ„ Thread.sleep() |
| Thread.interrupted()     | μΈν„°λ½νΈ μƒνƒλ¥Ό ν™•μΈν•κ³  λ™μ‹μ— μƒνƒλ¥Ό μ΄κΈ°ν™”ν•¨                        | μμ› μ •λ¦¬ μ „μ— νΈμ¶ν•΄ μƒνƒ λ³µκµ¬   |
| InterruptedException     | μμ™Έ λ°μƒ μ‹ μΈν„°λ½νΈ μƒνƒκ°€ μλ™μΌλ΅ falseλ΅ μ΄κΈ°ν™”λ¨                 | catch λΈ”λ΅                        |


## π” ν•µμ‹¬ μ”μ•½
- isInterrupted()λ” μƒνƒλ¥Ό ν™•μΈλ§ ν•λ―€λ΅, μ΄ν›„ sleep() κ°™μ€ μ½”λ“μ—μ„ μμ™Έκ°€ λ°μƒν•  μ μμ
- μμ› μ •λ¦¬ μ „μ— Thread.interrupted()λ¥Ό νΈμ¶ν•λ©΄ μƒνƒλ¥Ό μ΄κΈ°ν™”ν•΄μ„ μμ™Έλ¥Ό λ°©μ§€ν•  μ μμ
- InterruptedExceptionμ΄ λ°μƒν•λ©΄ μƒνƒλ” μλ™μΌλ΅ falseλ΅ λμ•„μ¤λ―€λ΅ catch λΈ”λ΅μ—μ„ μ•μ „ν•κ² μ²λ¦¬ κ°€λ¥

## π§© μμ› μ •λ¦¬ μ‹¤ν¨μ μ •ν™•ν• μ›μΈ
### π”¥ μƒν™© μ”μ•½
- work μ¤λ λ“λ” interrupt()λ¥Ό λ°›μ•„μ„ μΈν„°λ½νΈ μƒνƒκ°€ trueκ°€ λ¨
- while (!isInterrupted()) μ΅°κ±΄μΌλ΅ λ°λ³µλ¬Έμ„ νƒμ¶ν•¨ β†’ μ—¬κΈ°κΉμ§€λ” OK
- μ΄ν›„ μμ› μ •λ¦¬λ¥Ό μ„ν•΄ Thread.sleep(1000)μ„ νΈμ¶ν•¨
- κ·Έλ°λ° μ¤λ λ“μ μΈν„°λ½νΈ μƒνƒκ°€ μ—¬μ „ν trueμ€κΈ° λ•λ¬Έμ—
- sleep()μ€ μ¦‰μ‹ InterruptedExceptionμ„ λμ§
- κ²°κ³Όμ μΌλ΅ μμ› μ •λ¦¬ μ½”λ“κ°€ μμ™Έλ΅ μ¤‘λ‹¨λ¨

### π§ μ™ μ΄λ° μΌμ΄ μƒκ²Όλ”κ°€?

| ν•­λ©                  | μ„¤λ…                                                                 | κ²°κ³Ό λλ” μν–¥                         |
|-----------------------|----------------------------------------------------------------------|----------------------------------------|
| isInterrupted()       | μΈν„°λ½νΈ μƒνƒλ¥Ό ν™•μΈλ§ ν•κ³  μ΄κΈ°ν™”ν•μ§€ μ•μ                          | λ°λ³µλ¬Έμ€ νƒμ¶ν•μ§€λ§ μƒνƒλ” true μ μ§€     |
| sleep()               | μΈν„°λ½νΈ μƒνƒκ°€ trueμΌ κ²½μ° μ¦‰μ‹ InterruptedException λ°μƒ           | μμ› μ •λ¦¬ μ¤‘ μμ™Έ λ°μƒ β†’ μ‹¤ν¨           |
| InterruptedException  | μμ™Έ λ°μƒ μ‹ μΈν„°λ½νΈ μƒνƒκ°€ μλ™μΌλ΅ falseλ΅ μ΄κΈ°ν™”λ¨               | μ΄ν›„ μ½”λ“μ—μ„ μΈν„°λ½νΈ μν–¥ μ—†μ        |
| μƒνƒ μ΄κΈ°ν™” λ„λ½      | λ°λ³µλ¬Έ νƒμ¶ ν›„ μΈν„°λ½νΈ μƒνƒλ¥Ό μλ™μΌλ΅ μ΄κΈ°ν™”ν•μ§€ μ•μ              | μμ› μ •λ¦¬ μ½”λ“μ—μ„ μμ™Έ λ°μƒ             |
| μμ™Έ μ²λ¦¬ μ„μΉ        | μμ› μ •λ¦¬ μ½”λ“κ°€ try-catchλ΅ κ°μ‹Έμ Έ μμ§€ μ•κ±°λ‚ μμ™Έλ¥Ό μμƒν•μ§€ μ•μ | μμ› μ •λ¦¬ μ‹¤ν¨ κ°€λ¥μ„± μ¦κ°€              |

---





