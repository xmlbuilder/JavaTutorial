# ì¸í„°ëŸ½íŠ¸ ì‹¤ì „ ì˜ˆì œ 1
ì´ ì˜ˆì œëŠ” ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ì‚¬ìš©ì ì…ë ¥ì„ ì²˜ë¦¬í•˜ê³  í”„ë¦°í„° ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” êµ¬ì¡°ë¥¼ ë³´ì—¬ì£¼ë©°,  
`volatile` ê³¼ `ConcurrentLinkedQueue` ë¥¼ í™œìš©í•œ ê¸°ë³¸ì ì¸ ìŠ¤ë ˆë“œ í˜‘ì—… êµ¬ì¡°ë¥¼ ì˜ ì„¤ëª…í•˜ê³  ìˆìŒ.  
ì•„ë˜ì— ë‹¤ì´ì–´ê·¸ë¨ê³¼ í•¨ê»˜ ì½”ë“œ íë¦„ì„ ë‹¨ê³„ë³„ë¡œ ì •ë¦¬.

## ì†ŒìŠ¤ ì½”ë“œ
```java
public class MyPrinterV1 {
    public static void main(String[] args) throws InterruptedException {
        Printer printer = new Printer();
        Thread printerThread = new Thread(printer, "printer");
        printerThread.start();
        Scanner userInput = new Scanner(System.in);
        while (true) {
            log("í”„ë¦°í„°í•  ë¬¸ì„œë¥¼ ì…ë ¥í•˜ì„¸ìš”. ì¢…ë£Œ (q): ");
            String input = userInput.nextLine();
            if (input.equals("q")) {
                printer.work = false;
                break;
            }
            printer.addJob(input);
        }
    }

    static class Printer implements Runnable {
        volatile boolean work = true;
        Queue<String> jobQueue = new ConcurrentLinkedQueue<>();
        
        @Override
        public void run() {
            
            while (work) {
                if (jobQueue.isEmpty()) {
                    continue;
                }

                String job = jobQueue.poll();
                log("ì¶œë ¥ ì‹œì‘: " + job + ", ëŒ€ê¸° ë¬¸ì„œ: " + jobQueue);
                sleep(3000); //ì¶œë ¥ì— ê±¸ë¦¬ëŠ” ì‹œê°„
                log("ì¶œë ¥ ì™„ë£Œ: " + job);
            }

            log("í”„ë¦°í„° ì¢…ë£Œ");
        }
        
        public void addJob(String input) {
            jobQueue.offer(input);
        }
    }
}
```

## ğŸ§µ ë‹¤ì´ì–´ê·¸ë¨: í”„ë¦°í„° ì˜ˆì œ V1 íë¦„
```mermaid
sequenceDiagram
    participant MainThread
    participant PrinterThread
    participant PrinterInstance

    MainThread->>PrinterInstance: new Printer()
    MainThread->>PrinterThread: new Thread(printer).start()

    loop ì‚¬ìš©ì ì…ë ¥ ë°˜ë³µ
        MainThread->>MainThread: ì‚¬ìš©ì ì…ë ¥ ë°›ê¸°
        alt ì…ë ¥ == "q"
            MainThread->>PrinterInstance: printer.work = false
            MainThread->>MainThread: ì¢…ë£Œ
        else ì…ë ¥ != "q"
            MainThread->>PrinterInstance: printer.addJob(input)
        end
    end

    loop í”„ë¦°í„° ì‘ì—… ë°˜ë³µ
        PrinterThread->>PrinterInstance: while (work)
        alt jobQueue.isEmpty()
            PrinterThread->>PrinterThread: continue
        else jobQueue not empty
            PrinterThread->>PrinterInstance: jobQueue.poll()
            PrinterThread->>PrinterThread: sleep(3000)
            PrinterThread->>PrinterThread: ì¶œë ¥ ì™„ë£Œ
        end
    end

    PrinterThread->>PrinterThread: í”„ë¦°í„° ì¢…ë£Œ
```


## ğŸ§© ì½”ë“œ íë¦„ ë‹¨ê³„ë³„ ì„¤ëª…
### 1ï¸âƒ£ ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬ (main ìŠ¤ë ˆë“œ)
```java
while (true) {
    log("í”„ë¦°í„°í•  ë¬¸ì„œë¥¼ ì…ë ¥í•˜ì„¸ìš”. ì¢…ë£Œ (q): ");
    String input = userInput.nextLine();
    if (input.equals("q")) {
        printer.work = false;
        break;
    }
    printer.addJob(input);
}
```

- ì‚¬ìš©ì ì…ë ¥ì„ ë°›ì•„ jobQueueì— ì¶”ê°€
- "q" ì…ë ¥ ì‹œ work = falseë¡œ ì„¤ì •í•˜ì—¬ í”„ë¦°í„° ì¢…ë£Œ ìœ ë„

### 2ï¸âƒ£ í”„ë¦°í„° ì‘ì—… ì²˜ë¦¬ (printer ìŠ¤ë ˆë“œ)
```java
while (work) {
    if (jobQueue.isEmpty()) {
        continue;
    }
    String job = jobQueue.poll();
    log("ì¶œë ¥ ì‹œì‘: " + job + ", ëŒ€ê¸° ë¬¸ì„œ: " + jobQueue);
    sleep(3000); // ì¶œë ¥ ì‹œê°„
    log("ì¶œë ¥ ì™„ë£Œ: " + job);
}
log("í”„ë¦°í„° ì¢…ë£Œ");
```

- jobQueueê°€ ë¹„ì–´ ìˆìœ¼ë©´ continueë¡œ ëŒ€ê¸°
- ì‘ì—…ì´ ìˆìœ¼ë©´ êº¼ë‚´ì„œ 3ì´ˆê°„ ì¶œë ¥ ì²˜ë¦¬
- work == falseê°€ ë˜ë©´ ë°˜ë³µ ì¢…ë£Œ

## âš ï¸ ë¬¸ì œì  ìš”ì•½

| í•­ëª©                     | ì„¤ëª…                                                                 | ì˜í–¥ ë˜ëŠ” ê²°ê³¼                         |
|--------------------------|----------------------------------------------------------------------|----------------------------------------|
| sleep(3000) ì¤‘ work ì²´í¬ ë¶ˆê°€ | `printer` ìŠ¤ë ˆë“œê°€ sleep ìƒíƒœì¼ ë•ŒëŠ” `work` ê°’ì„ í™•ì¸í•  ìˆ˜ ì—†ìŒ        | ì¢…ë£Œ ì§€ì‹œ í›„ ìµœëŒ€ 3ì´ˆ ëŒ€ê¸° ë°œìƒ         |
| "q" ì…ë ¥ í›„ ì¦‰ì‹œ ë°˜ì‘ ë¶ˆê°€   | `main` ìŠ¤ë ˆë“œê°€ `work = false`ë¡œ ì„¤ì •í•´ë„ `printer` ìŠ¤ë ˆë“œëŠ” ì¦‰ì‹œ ë°˜ì‘ ëª»í•¨ | ì‚¬ìš©ì ê²½í—˜ ì €í•˜, ì¢…ë£Œ ì§€ì—°             |
| while ì¡°ê±´ ì²´í¬ ì§€ì—°        | `sleep()`ì´ ëë‚˜ì•¼ while ì¡°ê±´ì„ ë‹¤ì‹œ í™•ì¸í•¨                            | ë°˜ë³µë¬¸ íƒˆì¶œê¹Œì§€ ë¶ˆí•„ìš”í•œ ì‹œê°„ ì†Œìš”       |


## ğŸ” í•µì‹¬ ë¬¸ì œ
- sleep()ì€ ìŠ¤ë ˆë“œë¥¼ TIMED_WAITING ìƒíƒœë¡œ ë§Œë“¤ê¸° ë•Œë¬¸ì—, ê·¸ ì‹œê°„ ë™ì•ˆì€ ì¡°ê±´ ì²´í¬ê°€ ë¶ˆê°€ëŠ¥
- "q" ì…ë ¥ìœ¼ë¡œ ì¢…ë£Œë¥¼ ì§€ì‹œí•´ë„, printer ìŠ¤ë ˆë“œëŠ” ë‹¤ìŒ ë£¨í”„ê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ ë°˜ì‘
- ê²°ê³¼ì ìœ¼ë¡œ ìµœëŒ€ 3ì´ˆì˜ ì¢…ë£Œ ì§€ì—°ì´ ë°œìƒí•¨

---


